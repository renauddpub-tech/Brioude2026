<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8">
<title>Brioude 2026, a tale of AURA</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{margin:0;background:#000;display:flex;justify-content:center;align-items:center;height:100vh}
canvas{width:640px;height:480px;image-rendering:pixelated;background:#f3f0da}
</style>
</head>
<body>
<canvas id="game" width="320" height="240"></canvas>

<script>
(() => {

/* ===== CANVAS ===== */
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
ctx.imageSmoothingEnabled = false;
ctx.font = "12px monospace";
const W = canvas.width, H = canvas.height;

/* ===== ASSETS ===== */
const ASSETS = {
  sprites:{
    remy_back:"remy_back.png",
    wauquiez_front:"wauquiez_front.png",
    ciotti_front:"ciotti_front.png",
    maite_front:"maite_front.png",
    edile_front:"edile_front.png"
  },
  background:{ battle:"battle_bg.png" },
  ui:{ cursor:"cursor.png", textbox:"textbox.png" }
};

const IMG = {};
function preload(done){
  const list=[];
  Object.values(ASSETS.sprites).forEach(v=>list.push(v));
  Object.values(ASSETS.background).forEach(v=>list.push(v));
  Object.values(ASSETS.ui).forEach(v=>list.push(v));
  let c=0;
  list.forEach(src=>{
    const i=new Image();
    i.onload=()=>{IMG[src.replace(".png","")]=i;if(++c===list.length)done();};
    i.onerror=()=>{if(++c===list.length)done();};
    i.src=src;
  });
}

/* ===== UTILS ===== */
const clamp=(v,a,b)=>Math.max(a,Math.min(b,v));
const chance=p=>Math.random()<p;

/* ===== FX ===== */
const FX={sx:0,sy:0,sf:0,flash:0};
function shake(){FX.sf=6;}
function updateFX(){
  if(FX.sf>0){FX.sx=(Math.random()-0.5)*6;FX.sy=(Math.random()-0.5)*4;FX.sf--;}
  else FX.sx=FX.sy=0;
  if(FX.flash>0) FX.flash--;
}

/* ===== UI ===== */
const UI={text:"",queue:[],typing:false,i:0,t:0,menu:false,items:[],idx:0};
function show(t){UI.text=t;UI.typing=true;UI.i=0;UI.t=0;UI.menu=false;}
function q(t){UI.queue.push(t);}
function next(){
  if(UI.typing){UI.typ
